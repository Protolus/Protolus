// Compute employee attributes from Bargaining Units
var employeesByJob = employees.byGroup('job');
bargaining_units.forEach(function(unit){
    var myBU = employeesByJob[unit.job];
	if(!myBU) emit('warning', "no employees found for '"+ unit.job+"'!", unit);
    else myBU.forEach(function(employee, innn){
        employee.years_worked = ( current_year - (new Date(employee.start_date)).getFullYear() ) || 0;
        employee.start_step = employee.start_step?employee.start_step:1;
	    employee.step = Math.max(Math.min(employee.start_step+employee.years_worked, 5), 1);
	    employee.base_salary = unit['step_'+employee.step];
	    employee.total_cost = employee.base_salary;
    }.bind(this));
});

//zero new columns (hack to show column headers)
budget.forEach(function(item){
	item.rule_based = false;
    item.jobs = '';
});