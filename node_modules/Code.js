var jsParser = require("uglify-js").parser;
var jsCompressor = require("uglify-js").uglify;


var GLOBAL_ITEMS = function(){
	var items = [];
	for(var key in this) items.push(key);
	return items;
}();

(function(){
    this.Code = {};
    this.Code.minify = function(text){
        var result = '';
        var container = false;
        for(index in text){
            var ast = jsParser.parse(text);
            ast = jsCompressor.ast_mangle(ast); // mangle names
            ast = jsCompressor.ast_squeeze(ast); // compress
            return jsCompressor.gen_code(ast);
        }
    }
})();

if (typeof exports != 'undefined') (function(){
    for (var key in this) if (!GLOBAL_ITEMS.contains(key)){
        exports[key] = this[key];
    }
    exports.apply = function(object){
        Object.append(object, exports);
    };
})();

